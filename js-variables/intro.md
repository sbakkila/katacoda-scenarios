In this scenario, we will fix the variable declaration and scope related bugs, and also refactor the code to use `let` and `const` instead of `var`, so that we can avoid introducing similar bugs in the future!